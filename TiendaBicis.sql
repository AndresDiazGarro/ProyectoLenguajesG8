/* Nombre system
  Contraseñ±a DBFide1 */

CREATE TABLE Usuarios(
ID_Usuario NUMBER (38) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
Nombre VARCHAR2 (30) NOT NULL,
Apellido VARCHAR2 (30) NOT NULL,
Nom_Usuario VARCHAR2 (30) NOT NULL,
Contrasena VARCHAR2(20) NOT NULL,
Rol VARCHAR2(20) NOT NULL,
CONSTRAINT PK_Usuarios PRIMARY KEY(ID_Usuario)
);

CREATE TABLE Marca(
ID_marca NUMBER (38)GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
Nombre_marca VARCHAR2 (30) NOT NULL,
CONSTRAINT PK_Marca PRIMARY KEY(ID_marca)
);

CREATE TABLE Material(
ID_material NUMBER (38)GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
Nombre_material VARCHAR2 (30) NOT NULL,
CONSTRAINT PK_Material PRIMARY KEY(ID_material)
);

CREATE TABLE Marco(
ID_Marco NUMBER (38)GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
ID_Material NUMBER (38) NOT NULL,
Nombre_marco VARCHAR2 (30) NOT NULL,
ID_Marca NUMBER (38) NOT NULL,
CONSTRAINT PK_Marco PRIMARY KEY(ID_Marco),
CONSTRAINT FK_Material FOREIGN KEY (ID_Material) REFERENCES Material(ID_Material),
CONSTRAINT FK_Marca FOREIGN KEY (ID_Marca) REFERENCES Marca(ID_Marca)
);

CREATE TABLE Ruedas(
ID_Ruedas NUMBER (38)GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
ID_Material NUMBER (38) NOT NULL,
ID_Marca NUMBER (38) NOT NULL,
Nombre_ruedas VARCHAR2 (30) NOT NULL,
CONSTRAINT PK_Ruedas PRIMARY KEY(ID_Ruedas),
CONSTRAINT FK_MaterialRueda FOREIGN KEY (ID_Material) REFERENCES Material(ID_Material),
CONSTRAINT FK_MarcaRueda FOREIGN KEY (ID_Marca) REFERENCES Marca(ID_Marca)
);

CREATE TABLE Suspension(
ID_Suspension NUMBER (38)GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
ID_Material NUMBER (38) NOT NULL,
ID_Marca NUMBER (38) NOT NULL,
Nombre_Susp VARCHAR2 (30) NOT NULL,
CONSTRAINT PK_Suspension PRIMARY KEY(ID_Suspension),
CONSTRAINT FK_MaterialSusp FOREIGN KEY (ID_Material) REFERENCES Material(ID_Material),
CONSTRAINT FK_MarcaSusp FOREIGN KEY (ID_Marca) REFERENCES Marca(ID_Marca)
);

CREATE TABLE Transmision(
ID_Transmision NUMBER (38)GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
ID_Material NUMBER (38) NOT NULL,
ID_Marca NUMBER (38) NOT NULL,
Nombre_Transmision VARCHAR2 (30) NOT NULL,
CONSTRAINT PK_Transmision PRIMARY KEY(ID_Transmision),
CONSTRAINT FK_MaterialTrans FOREIGN KEY (ID_Material) REFERENCES Material(ID_Material),
CONSTRAINT FK_MarcaTrans FOREIGN KEY (ID_Marca) REFERENCES Marca(ID_Marca)
);

CREATE TABLE Frenos(
ID_Frenos NUMBER (38)GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
ID_Material NUMBER (38) NOT NULL,
ID_Marca NUMBER (38) NOT NULL,
Nombre_Frenos VARCHAR2 (30) NOT NULL,
CONSTRAINT PK_Frenos PRIMARY KEY(ID_Frenos),
CONSTRAINT FK_MaterialFrenos FOREIGN KEY (ID_Material) REFERENCES Material(ID_Material),
CONSTRAINT FK_MarcaFrenos FOREIGN KEY (ID_Marca) REFERENCES Marca(ID_Marca)
);

CREATE TABLE Bicicletas(
ID_Bicicleta NUMBER(38) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
Nombre VARCHAR2 (30) NOT NULL,
Precio NUMBER (7) NOT NULL,
ID_Frenos NUMBER (38) NOT NULL,
ID_Transmision NUMBER (38) NOT NULL,
ID_Suspension NUMBER(38) NOT NULL,
ID_Ruedas NUMBER(38) NOT NULL,
ID_Marco NUMBER(38) NOT NULL,
ID_Marca NUMBER(38) NOT NULL,
CONSTRAINT PK_Bicicletas PRIMARY KEY(ID_Bicicleta),
CONSTRAINT FK_TransmisionBici FOREIGN KEY (ID_Transmision) REFERENCES Transmision(ID_Transmision),
CONSTRAINT FK_MarcaBici FOREIGN KEY (ID_Marca) REFERENCES Marca(ID_Marca),
CONSTRAINT FK_FrenosBici FOREIGN KEY (ID_Frenos) REFERENCES Frenos(ID_Frenos),
CONSTRAINT FK_MarcoBici FOREIGN KEY (ID_Marco) REFERENCES Marco(ID_Marco),
CONSTRAINT FK_SuspensionBici FOREIGN KEY (ID_Suspension) REFERENCES Suspension(ID_Suspension),
CONSTRAINT FK_RuedasBici FOREIGN KEY (ID_Ruedas) REFERENCES Ruedas(ID_Ruedas)
);

CREATE TABLE Factura(
ID_Factura VARCHAR2(30) NOT NULL,
NOMBRE VARCHAR2(20) NOT NULL,
APELLIDO VARCHAR2(20) NOT NULL,
USUARIO VARCHAR2 (30),
CEDULA NUMBER (38) NOT NULL,
TERMINOS VARCHAR2 (50) NOT NULL,
FECHA VARCHAR2 (10) NOT NULL
);


CREATE TABLE DetalleFactura(
DESCRIPCION VARCHAR2(50) NOT NULL,
CANTIDAD NUMBER(5) NOT NULL,
PRECIO NUMBER(7) NOT NULL,
MONTO NUMBER(10) NOT NULL,
ID_FACTURA VARCHAR2(30) NOT NULL
);

CREATE TABLE Coordenadas (
ID_SUCURSAL NUMBER (5) NOT NULL,
NOMBRE_SUCURSAL VARCHAR2 (50) NOT NULL,
LATITUD DECIMAL (20,10) NOT NULL,
LONGITUD DECIMAL (20,10) NOT NULL,
DIRECCION VARCHAR2 (150)
);

CREATE TABLE HISTORICO_FACTURA (
ID_FACTURA VARCHAR2(30) NOT NULL,
NOMBRE VARCHAR2(20) NOT NULL,
APELLIDO VARCHAR2(20) NOT NULL,
USUARIO VARCHAR2(30),
IDENTIFICACION NUMBER(38) NOT NULL,
TERMINOS VARCHAR2(50) NOT NULL,
FECHA VARCHAR2(10) NOT NULL
);

CREATE TABLE HISTORICO_DETALLE (
DESCRIPCION VARCHAR2(50) NOT NULL,
CANTIDAD  NUMBER(5) NOT NULL,
PRECIO NUMBER(7) NOT NULL,
MONTO NUMBER(10) NOT NULL,
ID_FACTURA VARCHAR2(30) NOT NULL
);

create table taller(
    ID_Bicicleta_Taller number(38) generated by default on null as identity,
    ID_BICICLETA number(38) not null,
    NOMBRE VARCHAR2(30) NOT NULL,
    NOMBRE_FRENOS VARCHAR2(30) NOT NULL,
    NOMBRE_TRANSMISION VARCHAR2(30),
    NOMBRE_SUSP VARCHAR2(30) NOT NULL,
    NOMBRE_RUEDAS VARCHAR2(30) NOT NULL,
    NOMBRE_MARCO VARCHAR2(30) NOT NULL,
    Nombre_MARCA VARCHAR2(30) NOT NULL,
    PROBLEMAS_REPORTADOS VARCHAR2(100) NOT NULL,
    OBSERVACIONES_MECANICO VARCHAR2(100) NOT NULL,
    MECANICO_REVISION VARCHAR2(30) NOT NULL,
    PRECIO_REVISION NUMBER(7) NOT NULL
);

--AUDITORIA DE TABLA TALLER

CREATE TABLE AUDITORIA_TALLER (
Id_Record NUMBER GENERATED ALWAYS AS IDENTITY,
Accion VARCHAR2(200),
Usuario VARCHAR2(20),
Fecha DATE,
PRIMARY KEY (Id_Record)
);

--AUDITORIA DE TABLA BICICLETAS
CREATE TABLE AUDITORIA_BICICLETAS (
Id_Record NUMBER GENERATED ALWAYS AS IDENTITY,
Accion VARCHAR2(200),
Usuario VARCHAR2(20),
Fecha DATE,
PRIMARY KEY (Id_Record)
);

--AUDITORIA DE TABLA USUARIOS
CREATE TABLE AUDITORIA_USUARIOS (
Id_Record NUMBER GENERATED ALWAYS AS IDENTITY,
Accion VARCHAR2(200),
Usuario VARCHAR2(20),
Fecha DATE,
PRIMARY KEY (Id_Record)
);

--------------------------------INSERTS DE DATOS-------------------------------------
--Marca Inserts
INSERT ALL 
INTO MARCA (ID_marca, Nombre_marca) VALUES (1,'Specialized')
INTO MARCA (ID_marca, Nombre_marca) VALUES (2,'Scott')
INTO MARCA (ID_marca, Nombre_marca) VALUES (3,'Trek')
INTO MARCA (ID_marca, Nombre_marca) VALUES (4,'Giant')
INTO MARCA (ID_marca, Nombre_marca) VALUES (5,'Pinarello')
INTO MARCA (ID_marca, Nombre_marca) VALUES (6,'Cannondale')
INTO MARCA (ID_marca, Nombre_marca) VALUES (7,'Fairlight')
INTO MARCA (ID_marca, Nombre_marca) VALUES (8,'Fearless')
INTO MARCA (ID_marca, Nombre_marca) VALUES (9,'Argon')
INTO MARCA (ID_marca, Nombre_marca) VALUES (10,'Zipp')
INTO MARCA (ID_marca, Nombre_marca) VALUES (11,'Hunt')
INTO MARCA (ID_marca, Nombre_marca) VALUES (12,'RockShox')
INTO MARCA (ID_marca, Nombre_marca) VALUES (13,'Fox')
INTO MARCA (ID_marca, Nombre_marca) VALUES (14,'Shimano')
INTO MARCA (ID_marca, Nombre_marca) VALUES (15,'Campagnolo')
SELECT * FROM dual;

--Material Inserts
INSERT ALL 
INTO MATERIAL (ID_MATERIAL, Nombre_MATERIAL) VALUES (51,'Acero')
INTO MATERIAL (ID_MATERIAL, Nombre_MATERIAL) VALUES (52,'Aluminio')
INTO MATERIAL (ID_MATERIAL, Nombre_MATERIAL) VALUES (53,'Fibra de Carbono')
INTO MATERIAL (ID_MATERIAL, Nombre_MATERIAL) VALUES (54,'Titanio')
SELECT * FROM dual;

--Marco Inserts
INSERT ALL 
INTO MARCO (ID_MARCO, ID_MATERIAL, NOMBRE_MARCO, ID_MARCA) VALUES (71,52,'Strael 3.0', 7)
INTO MARCO (ID_MARCO, ID_MATERIAL, NOMBRE_MARCO, ID_MARCA) VALUES (72,53,'Fearless', 8)
INTO MARCO (ID_MARCO, ID_MATERIAL, NOMBRE_MARCO, ID_MARCA) VALUES (73,54,'Krypton Pro', 9)
SELECT * FROM dual;

--Ruedas Inserts
INSERT ALL 
INTO RUEDAS (ID_RUEDAS, ID_MATERIAL, ID_MARCA, NOMBRE_RUEDAS) VALUES (91,53,10,'Carbon Aero')
INTO RUEDAS (ID_RUEDAS, ID_MATERIAL, ID_MARCA, NOMBRE_RUEDAS) VALUES (92,53,11,'Razing Zero')
INTO RUEDAS (ID_RUEDAS, ID_MATERIAL, ID_MARCA, NOMBRE_RUEDAS) VALUES (93,52,10,'Firecrest Carbon')
SELECT * FROM dual;

--Suspension Inserts
INSERT ALL 
INTO SUSPENSION (ID_SUSPENSION, ID_MATERIAL, ID_MARCA, NOMBRE_SUSP) VALUES (101,52,12,'Float Factory')
INTO SUSPENSION (ID_SUSPENSION, ID_MATERIAL, ID_MARCA, NOMBRE_SUSP) VALUES (102,53,12,'SID Ultimate')
INTO SUSPENSION (ID_SUSPENSION, ID_MATERIAL, ID_MARCA, NOMBRE_SUSP) VALUES (103,52,13,'Creek Helm')
SELECT * FROM dual;

--Transmision Inserts
INSERT ALL 
INTO TRANSMISION (ID_TRANSMISION, ID_MATERIAL, ID_MARCA, NOMBRE_TRANSMISION) VALUES (131,51,15,'Rohloffus')
INTO TRANSMISION (ID_TRANSMISION, ID_MATERIAL, ID_MARCA, NOMBRE_TRANSMISION) VALUES (132,53,14,'Rocketer')
SELECT * FROM dual;

--Frenos Inserts
INSERT ALL 
INTO FRENOS (ID_FRENOS, ID_MATERIAL, ID_MARCA, NOMBRE_FRENOS) VALUES (151,53,14,'XTR')
INTO FRENOS (ID_FRENOS, ID_MATERIAL, ID_MARCA, NOMBRE_FRENOS) VALUES (152,53,14,'Deore XT')
SELECT * FROM dual;

--Bicicletas Inserts
INSERT ALL 
INTO BICICLETAS (ID_BICICLETA, NOMBRE, PRECIO, ID_FRENOS, ID_TRANSMISION,ID_SUSPENSION,ID_RUEDAS,ID_MARCO,ID_MARCA) VALUES (301,'Sierra MTB',4000,151,132,101,92,72,1)
INTO BICICLETAS (ID_BICICLETA, NOMBRE, PRECIO, ID_FRENOS, ID_TRANSMISION,ID_SUSPENSION,ID_RUEDAS,ID_MARCO,ID_MARCA) VALUES (302,'RoadTreader Z',5685,152,131,103,93,71,3)
SELECT * FROM dual;

--Coordenadas Inserts
INSERT INTO COORDENADAS (ID_SUCURSAL, NOMBRE_SUCURSAL, LATITUD, LONGITUD, DIRECCION) VALUES (01, 'San Jose', 9.9363147, -84.0790631,'Avenida 4ta, de Correos de Costa Rica, 100mts Sur y 125 Oeste.');
INSERT INTO COORDENADAS (ID_SUCURSAL, NOMBRE_SUCURSAL, LATITUD, LONGITUD, DIRECCION) VALUES (02, 'Alajuela', 9.989498, -84.2874799, 'Centro Alajuela, de KFC 150mts Norte y 75 Este.');
INSERT INTO COORDENADAS (ID_SUCURSAL, NOMBRE_SUCURSAL, LATITUD, LONGITUD, DIRECCION) VALUES (03, 'Cartago', 9.8667534, -84.0633935,'Tejar, del Mas x Menos 75mts al Sur y 25 al Oeste.');
INSERT INTO COORDENADAS (ID_SUCURSAL, NOMBRE_SUCURSAL, LATITUD, LONGITUD, DIRECCION) VALUES (04, 'Heredia', 9.9971108, -84.1892609, 'Centro Comercial Paseo de las Flores, Local # 33.');
INSERT INTO COORDENADAS (ID_SUCURSAL, NOMBRE_SUCURSAL, LATITUD, LONGITUD, DIRECCION) VALUES (05, 'Limon', 10.3251669, -83.7215197, 'Del Chino los Aces, 25mts al Sur.');

--taller insert de prueba
insert into taller (ID_BICICLETA,NOMBRE,NOMBRE_FRENOS,NOMBRE_TRANSMISION,NOMBRE_SUSP,NOMBRE_RUEDAS,NOMBRE_MARCO,NOMBRE_MARCA,PROBLEMAS_REPORTADOS,OBSERVACIONES_MECANICO,MECANICO_REVISION,PRECIO_REVISION)values
(303, 'SCOTT SCALE 925 BIKE', 'SHIMANO DISC BRAKES', 'Shimano XT-SLX 12', 'Creek Helm','Syncros X-25 TR Rims',
'FOX 32 Float Rhythm 100mm Fork','SCOTT','Me hace brr cuando subo cuestas','Cadena esta oxidada',
'Juan','25000');
